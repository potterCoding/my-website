<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="系统设计在面试中一定是最让面试者头疼的事情之一。因为系统设计相关的问题通常是开放式的,所以没有标准答案。你在和面试官思想的交流碰撞中会慢慢优化自己的系统设计方案。理论上来说,系统设计面试官一起一步一步改进原有系统设计方案的过程。 系统设计题往往也非常能考察岀面试者的综合能力,回答好的话,很易就能在面试中脱颖而岀。不论是对于参加社招还是校招的小伙伴,都很有必要重视起来接下来。 我会带着小伙伴们从我的">
<meta property="og:type" content="article">
<meta property="og:title" content="如何准备系统设计面试">
<meta property="og:url" content="http://example.com/2025/01/02/share/new-interview/system-design/index.html">
<meta property="og:site_name" content="程序员波特的个人博客">
<meta property="og:description" content="系统设计在面试中一定是最让面试者头疼的事情之一。因为系统设计相关的问题通常是开放式的,所以没有标准答案。你在和面试官思想的交流碰撞中会慢慢优化自己的系统设计方案。理论上来说,系统设计面试官一起一步一步改进原有系统设计方案的过程。 系统设计题往往也非常能考察岀面试者的综合能力,回答好的话,很易就能在面试中脱颖而岀。不论是对于参加社招还是校招的小伙伴,都很有必要重视起来接下来。 我会带着小伙伴们从我的">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/share/new-interview/b1a58f5a-1be3-4365-ad9a-e2f61fad53f0-16657490089161.png">
<meta property="og:image" content="http://example.com/images/share/new-interview/b6868b10-8e2f-4b4c-899a-ae93248a2640.png">
<meta property="og:image" content="http://example.com/images/share/new-interview/233dc15c-ea84-4a23-b679-ebaa1763b70b.png">
<meta property="og:image" content="http://example.com/images/share/new-interview/20210625085635200.png">
<meta property="og:image" content="http://example.com/images/share/new-interview/image-20221014203252561.png">
<meta property="og:image" content="http://example.com/images/share/new-interview/20210510110935773.png">
<meta property="og:image" content="http://example.com/images/share/new-interview/2021051011143961.png">
<meta property="og:image" content="http://example.com/images/share/new-interview/20210625091858288.png">
<meta property="og:image" content="http://example.com/images/share/new-interview/20210624203212318.png">
<meta property="article:published_time" content="2025-01-02T04:00:00.000Z">
<meta property="article:modified_time" content="2025-03-03T14:06:21.353Z">
<meta property="article:author" content="程序员波特">
<meta property="article:tag" content="面试题">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/share/new-interview/b1a58f5a-1be3-4365-ad9a-e2f61fad53f0-16657490089161.png">

<link rel="canonical" href="http://example.com/2025/01/02/share/new-interview/system-design/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>如何准备系统设计面试 | 程序员波特的个人博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">程序员波特的个人博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">一个小而美的程序员编程资料站</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/01/02/share/new-interview/system-design/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="程序员波特">
      <meta itemprop="description" content="程序员编程资料站">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="程序员波特的个人博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          如何准备系统设计面试
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-01-02 12:00:00" itemprop="dateCreated datePublished" datetime="2025-01-02T12:00:00+08:00">2025-01-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-03 22:06:21" itemprop="dateModified" datetime="2025-03-03T22:06:21+08:00">2025-03-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%9C%BA%E6%99%AF%E9%9D%A2%E8%AF%95%E9%A2%98/" itemprop="url" rel="index"><span itemprop="name">企业级场景面试题</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><strong>系统设计在面试中一定是最让面试者头疼的事情之一</strong>。因为系统设计相关的问题通常是开放式的,所以没有标准答案。你在和面试官思想的交流碰撞中会慢慢优化自己的系统设计方案。理论上来说,系统设计面试官一起一步一步改进原有系统设计方案的过程。</p>
<p>系统设计题往往也非常能考察岀面试者的综合能力,回答好的话,很易就能在面试中脱颖而岀。不论是对于参加社招还是校招的小伙伴,都很有必要重视起来接下来。</p>
<p>我会带着小伙伴们从我的角度出发来谈谈:<strong>如何准备面试中的系统设计</strong></p>
<p>由于文章篇幅有限,就不列举实际例子了,可能会在后面的文章中单独提一些具体的例子</p>
<p><strong>系统设计面试一般怎么问</strong></p>
<p>我简单总下系统设计面试相关问题的问法个</p>
<ol>
<li>设计某某系统比如秒杀系统、微博系统、抢红包系统、短网址系统</li>
<li>设计某某系统中一个功能比如哔哩哔哩点赞功能</li>
<li>设计一个框架比如RPC框架、消息队列、缓存框架、分布式文件系统等等</li>
<li>某某系统的技术选型比如缓存用<code>Redis</code>还是<code>Memcached</code>、网关用<code>Spring Cloud Gateway</code>还是<code>Netflix Zuul2</code></li>
</ol>
<h4 id="系统设计怎么做？"><a href="#系统设计怎么做？" class="headerlink" title="系统设计怎么做？"></a><strong>系统设计怎么做？</strong></h4><p>我们将步骤总结成了以下 4 步。</p>
<h5 id="Step1-问清楚系统具体要求"><a href="#Step1-问清楚系统具体要求" class="headerlink" title="Step1:问清楚系统具体要求"></a><strong>Step1:问清楚系统具体要求</strong></h5><p><strong>当面试官给出了系统设计题目之后，一定不要立即开始设计解决方案</strong>。 你需要先理解系统设计的需求：功能性需求和非功能性需求。</p>
<p>为了避免自己曲解题目所想要解决的问题，你可以先简要地给面试官说说自己的理解，</p>
<p><strong>为啥要询问清楚系统的功能性需求也就是说系统包含哪些功能呢？</strong></p>
<p>毕竟，如果面试官冷不丁地直接让你设计一个微博系统，你不可能把微博系统涵盖的功能比如推荐信息流、会员机制等一个一个都列举出来，然后再去设计吧！你需要筛选出系统所提供的核心功能（<strong>缩小边界范围</strong>）！</p>
<p><strong>为啥要询问清楚系统的非功能性需求或者说约束条件比如系统需要达到多少QPS呢？</strong></p>
<p>让你设计一个1w人用的微博系统和100w人用的微博系统能一样么？不同的约束系统对应的系统设计方案肯定是不一样的。</p>
<h5 id="Step2-对系统进行抽象设计"><a href="#Step2-对系统进行抽象设计" class="headerlink" title="Step2:对系统进行抽象设计"></a><strong>Step2:对系统进行抽象设计</strong></h5><p>我们需要在一个 High Level 的层面对系统进行设计。</p>
<p>你可以画出系统的抽象架构图，这个抽象架构图中包含了系统的一些组件以及这些组件之间的连接。</p>
<h5 id="Step3-考虑系统目前需要优化的点"><a href="#Step3-考虑系统目前需要优化的点" class="headerlink" title="Step3:考虑系统目前需要优化的点"></a><img src="/images/share/new-interview/b1a58f5a-1be3-4365-ad9a-e2f61fad53f0-16657490089161.png" alt="img"><strong>Step3:考虑系统目前需要优化的点</strong></h5><p>对系统进行抽象设计之后，你需要思考当前抽象的系统设计有哪些需要优化的点，比如说：</p>
<ol>
<li>当前系统部署在一台机器够吗？是否需要部署在多台机器然后进行负载均衡呢？</li>
<li>数据库处理速度能否支撑业务需求？是否需要给指定字段加索引？是否需要读写分离？是否需要缓存？</li>
<li>数据量是否大到需要分库分表？</li>
<li>是否存在安全隐患？</li>
<li>系统是否需要分布式文件系统？</li>
<li>……</li>
</ol>
<h5 id="Step4-优化你的系统抽象设计"><a href="#Step4-优化你的系统抽象设计" class="headerlink" title="Step4:优化你的系统抽象设计"></a><strong>Step4:优化你的系统抽象设计</strong></h5><p>根据 Step 3 中的“系统需要优化的点” 对系统的抽象设计做进一步完善。</p>
<h4 id="系统设计该如何准备？"><a href="#系统设计该如何准备？" class="headerlink" title="系统设计该如何准备？"></a><strong>系统设计该如何准备？</strong></h4><h5 id="知识储备"><a href="#知识储备" class="headerlink" title="知识储备"></a>知识储备</h5><p>系统设计面试非常考察你的知识储备，系统设计能力的提高需要大量的理论知识储备。比如说你要知道大型网站架构设计必备的三板斧：</p>
<p><strong>1.高性能架构设计：</strong> 熟悉系统常见性能优化手段比如引入 读写分离、缓存、负载均衡、异步 等等。</p>
<p>**2.高可用架构设计 ：**CAP理论和BASE理论、通过集群来提高系统整体稳定性、超时和重试机制、应对接口级故障：降级、熔断、限流、排队。</p>
<p>**3.高扩展架构设计 ：**说白了就是懂得如何拆分系统。你按照不同的思路来拆分软件系统，就会得到不同的架构。</p>
<h5 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h5><p>虽然懂得了理论，但是自己没有进行实践的话，很多东西是无法体会到的！</p>
<p>因此，你还要<strong>不断通过实战项目锻炼自己的系统设计能力</strong>。</p>
<h5 id="保持好奇心"><a href="#保持好奇心" class="headerlink" title="保持好奇心"></a>保持好奇心</h5><p>多思考自己经常浏览的网站是怎么做的。比如：</p>
<p>1你刷微博的时候可以思考一下微博是如何记录点赞数量的？</p>
<p>2你看哔哩哔哩的时候可以思考一下消息提醒系统是如何做的？</p>
<p>3你使用短链系统的时候可以考虑一下短链系统是如何做的？</p>
<p>4……</p>
<h5 id="技术选型"><a href="#技术选型" class="headerlink" title="技术选型"></a>技术选型</h5><p>实现同样的功能，一般会有多种技术选择方案，比如缓存用Redis 还是 <code>Memcached</code>、网关用<code>Spring Cloud Gateway</code>还是<code>Netflix Zuul2</code> 。 很多时候，面试官在系统设计面过程中会具体到技术的选型，因而，你需要区分不同技术的优缺点。</p>
<h4 id="系统设计面试必知"><a href="#系统设计面试必知" class="headerlink" title="系统设计面试必知"></a>系统设计面试必知</h4><blockquote>
<p>系统设计的时候必然离不开描述性能相关的指标比如 QPS。</p>
</blockquote>
<h5 id="性能相关的指标"><a href="#性能相关的指标" class="headerlink" title="性能相关的指标"></a>性能相关的指标</h5><h6 id="响应时间"><a href="#响应时间" class="headerlink" title="响应时间"></a>响应时间</h6><p><strong>响应时间RT(Response-time)就是用户发出请求到用户收到系统处理结果所需要的时间。</strong></p>
<p>RT是一个非常重要且直观的指标，RT数值大小直接反应了系统处理用户请求速度的快慢。</p>
<h6 id="并发数"><a href="#并发数" class="headerlink" title="并发数"></a>并发数</h6><p><strong>并发数可以简单理解为系统能够同时供多少人访问使用也就是说系统同时能处理的请求数量。</strong></p>
<p>并发数反应了系统的负载能力。</p>
<h6 id="QPS-和-TPS"><a href="#QPS-和-TPS" class="headerlink" title="QPS 和 TPS"></a>QPS 和 TPS</h6><ul>
<li><p><strong>QPS（Query Per Second）</strong> ：服务器每秒可以执行的查询次数；</p>
</li>
<li><p><strong>TPS（Transaction Per Second）</strong> ：服务器每秒处理的事务数（这里的一个事务可以理解为客户发出请求到收到服务器的过程）；</p>
</li>
</ul>
<p>书中是这样描述 QPS 和 TPS 的区别的。</p>
<blockquote>
<p>QPS vs TPS：QPS 基本类似于 TPS，但是不同的是，对于一个页面的一次访问，形成一个TPS；但一次页面请求，可能产生多次对服务器的请求，服务器对这些请求，就可计入“QPS”之中。如，访问一个页面会请求服务器2次，一次访问，产生一个“T”，产生2个“Q”。</p>
</blockquote>
<h6 id="吞吐量"><a href="#吞吐量" class="headerlink" title="吞吐量"></a>吞吐量</h6><p><strong>吞吐量指的是系统单位时间内系统处理的请求数量。</strong></p>
<p>一个系统的吞吐量与请求对系统的资源消耗等紧密关联。请求对系统资源消耗越多，系统吞吐能力越低，反之则越高。</p>
<p>TPS、QPS都是吞吐量的常用量化指标。</p>
<ul>
<li><p>QPS（TPS） &#x3D; 并发数&#x2F;平均响应时间(RT)</p>
</li>
<li><p>并发数 &#x3D; QPS * 平均响应时间(RT)</p>
</li>
</ul>
<h5 id="系统活跃度"><a href="#系统活跃度" class="headerlink" title="系统活跃度"></a>系统活跃度</h5><p>介绍几个描述系统活跃度的常见名词，建议牢牢记住。你不光会在回答系统设计面试题的时候碰到，日常工作中你也会经常碰到这些名词。</p>
<h6 id="PV-Page-View"><a href="#PV-Page-View" class="headerlink" title="PV(Page View)"></a>PV(Page View)</h6><p>访问量, 即页面浏览量或点击量，衡量网站用户访问的网页数量；在一定统计周期内用户每打开或刷新一个页面就记录1次，多次打开或刷新同一页面则浏览量累计。UV 从网页打开的数量&#x2F;刷新的次数的角度来统计的。</p>
<h6 id="UV-Unique-Visitor"><a href="#UV-Unique-Visitor" class="headerlink" title="UV(Unique Visitor)"></a>UV(Unique Visitor)</h6><p>独立访客，统计1天内访问某站点的用户数。1天内相同访客多次访问网站，只计算为1个独立访客。UV 是从用户个体的角度来统计的。</p>
<h6 id="DAU-Daily-Active-User"><a href="#DAU-Daily-Active-User" class="headerlink" title="DAU(Daily Active User)"></a>DAU(Daily Active User)</h6><p>日活跃用户数量。</p>
<h6 id="MAU-monthly-active-users"><a href="#MAU-monthly-active-users" class="headerlink" title="MAU(monthly active users)"></a>MAU(monthly active users)</h6><p>月活跃用户人数。</p>
<p>举例：某网站 DAU为 1200w， 用户日均使用时长 1 小时，RT为0.5s，求并发量和QPS。</p>
<p>平均并发量 &#x3D; DAU（1200w）* 日均使用时长（1 小时，3600秒） &#x2F;一天的秒数（86400）&#x3D;1200w&#x2F;24 &#x3D; 50w</p>
<p>真实并发量（考虑到某些时间段使用人数比较少） &#x3D; DAU（1200w）* 日均使用时长（1 小时，3600秒） &#x2F;一天的秒数-访问量比较小的时间段假设为8小时（57600）&#x3D;1200w&#x2F;16 &#x3D; 75w</p>
<p>峰值并发量 &#x3D; 平均并发量 * 6 &#x3D; 300w</p>
<p>QPS &#x3D; 真实并发量&#x2F;RT &#x3D; 75W&#x2F;0.5&#x3D;150w&#x2F;s</p>
<h5 id="常用性能测试工具"><a href="#常用性能测试工具" class="headerlink" title="常用性能测试工具"></a>常用性能测试工具</h5><h6 id="后端常用"><a href="#后端常用" class="headerlink" title="后端常用"></a>后端常用</h6><p>既然系统设计涉及到系统性能方面的问题，那在面试的时候，面试官就很可能会问：<strong>你是如何进行性能测试的？</strong></p>
<p>推荐 4 个比较常用的性能测试工具：</p>
<ol>
<li><p>Jmeter ：Apache JMeter 是 JAVA 开发的性能测试工具。</p>
</li>
<li><p>LoadRunner：一款商业的性能测试工具。</p>
</li>
<li><p>Galtling ：一款基于Scala 开发的高性能服务器性能测试工具。</p>
</li>
<li><p>ab ：全称为 Apache Bench 。Apache 旗下的一款测试工具，非常实用。</p>
</li>
</ol>
<p>没记错的话，除了 <strong>LoadRunner</strong> 其他几款性能测试工具都是开源免费的。</p>
<h6 id="前端常用"><a href="#前端常用" class="headerlink" title="前端常用"></a>前端常用</h6><ol>
<li><p>Fiddler：抓包工具，它可以修改请求的数据，甚至可以修改服务器返回的数据，功能非常强大，是Web 调试的利器。</p>
</li>
<li><p>HttpWatch: 可用于录制HTTP请求信息的工具。</p>
</li>
</ol>
<h5 id="常见软件的QPS"><a href="#常见软件的QPS" class="headerlink" title="常见软件的QPS"></a>常见软件的QPS</h5><p>这里给出的 QPS 仅供参考，实际项目需要进行压测来计算。</p>
<ul>
<li><p>Nginx ：一般情况下，系统的性能瓶颈基本不会是 Nginx。单机 Nginx 可以达到 30w +。</p>
</li>
<li><p>Redis:  Redis 官方的性能测试报告：<a target="_blank" rel="noopener" href="https://redis.io/topics/benchmarks">https://redis.io/topics/benchmarks</a>  。从报告中，我们可以得出 Redis 的单机 QPS 可以达到 8w+（CPU性能有关系，也和执行的命令也有关系比如执行 SET 命令甚至可以达到10w+QPS）。</p>
</li>
<li><p>MySQL:  MySQL 单机的 QPS 为 大概在 4k 左右。</p>
</li>
<li><p>Tomcat ：单机 Tomcat 的QPS 在 2w左右。这个和你的 Tomcat 配置有很大关系，举个例子Tomcat 支持的连接器有 NIO、NIO.2 和 APR。 AprEndpoint 是通过 JNI 调用 APR 本地库而实现非阻塞 I&#x2F;O 的，性能更好，Tomcat 配置 APR 为 连接器的话，QPS 可以达到 3w左右。更多相关内容可以自行搜索 Tomcat 性能优化。</p>
</li>
</ul>
<h5 id="系统设计原则"><a href="#系统设计原则" class="headerlink" title="系统设计原则"></a>系统设计原则</h5><p><strong>合适优于先进 &gt; 演化优于一步到位 &gt; 简单优于复杂</strong></p>
<h5 id="常见的性能优化策略"><a href="#常见的性能优化策略" class="headerlink" title="常见的性能优化策略"></a>常见的性能优化策略</h5><p>性能优化之前我们需要对请求经历的各个环节进行分析，排查出可能出现性能瓶颈的地方，定位问题。</p>
<p>下面是一些性能优化时，我经常拿来自问的一些问题：</p>
<ol>
<li><p>当前系统的SQL语句是否存在问题？</p>
</li>
<li><p>当前系统是否需要升级硬件？</p>
</li>
<li><p>系统是否需要缓存？</p>
</li>
<li><p>系统架构本身是不是就有问题？</p>
</li>
<li><p>系统是否存在死锁的地方？</p>
</li>
<li><p>数据库索引使用是否合理？</p>
</li>
<li><p>系统是否存在内存泄漏？（Java 的自动回收内存虽然很方便，但是，有时候代码写的不好真的会造成内存泄漏）</p>
</li>
<li><p>系统的耗时操作进行了异步处理？</p>
</li>
<li><p>……</p>
</li>
</ol>
<h5 id="性能优化必知法则"><a href="#性能优化必知法则" class="headerlink" title="性能优化必知法则"></a>性能优化必知法则</h5><p><strong>SQL优化，JVM、DB，Tomcat参数调优 &gt; 硬件性能优化（内存升级、CPU核心数增加、机械硬盘—&gt;固态硬盘等等）&gt; 业务逻辑优化&#x2F;缓存 &gt; 读写分离、集群等 &gt; 分库分表</strong></p>
<h4 id="系统设计面试的注意事项"><a href="#系统设计面试的注意事项" class="headerlink" title="系统设计面试的注意事项"></a>系统设计面试的注意事项</h4><h5 id="想好再说"><a href="#想好再说" class="headerlink" title="想好再说"></a>想好再说</h5><p>没必要面试官刚问了问题之后，你没准备好就开始回答。这样不会给面试官带来好印象的！系统设计本就需要面试者结合自己的以往的经验进行思考，这个过程是需要花费一些时间的。</p>
<h5 id="没有绝对的答案"><a href="#没有绝对的答案" class="headerlink" title="没有绝对的答案"></a>没有绝对的答案</h5><p>系统设计没有标准答案。重要的是你和面试官一起交流的过程。</p>
<p>一般情况下，你会在和面试官的交流过程中，一步一步完成系统设计。这个过程中，你会在面试官的引导下不断完善自己的系统设计方案。</p>
<p>因此，你不必要在系统设计面试之前找很多题目，然后只是单纯记住他们的答案。</p>
<h5 id="勿要绝对"><a href="#勿要绝对" class="headerlink" title="勿要绝对"></a>勿要绝对</h5><p>系统设计没有最好的设计方案，只有最合适的设计方案。这就类比架构设计了：<strong>软件开发没有银弹，架构设计的目的就是选择合适的解决方案。 何为银弹？</strong> 狼人传说中，只有银弹(银质子弹)才能制服这些猛兽。对应到软件开发活动中，银弹特指开发者们寻求的一种克服软件开发这个难缠的猛兽的“万能钥匙🔑”。</p>
<h5 id="权衡利弊"><a href="#权衡利弊" class="headerlink" title="权衡利弊"></a>权衡利弊</h5><p>知道使用某个技术可能会为系统带来的利弊。比如使用消息队列的好处是解耦和削峰，但是，同样也让系统可用性降低、复杂性提高，同时还会存在一致性问题（消息丢失或者消息未被消费咋办）。</p>
<h5 id="慢慢优化"><a href="#慢慢优化" class="headerlink" title="慢慢优化"></a>慢慢优化</h5><p>刚开始设计的系统不需要太完美，可以慢慢优化。</p>
<h5 id="不追新技术"><a href="#不追新技术" class="headerlink" title="不追新技术"></a>不追新技术</h5><p>使用稳定的、适合业务的技术，不必要过于追求新技术。</p>
<h5 id="追简避杂"><a href="#追简避杂" class="headerlink" title="追简避杂"></a>追简避杂</h5><p>系统设计应当追求简单避免复杂。KISS（ Keep It Simple, Stupid）原则——保持简单，易于理解。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>这篇文章简单带着小伙伴们分析了一下系统设计面试。如果你还想要深入学习的话，可以参考： <a target="_blank" rel="noopener" href="https://github.com/donnemartin/system-design-primer">https://github.com/donnemartin/system-design-primer</a>  。</p>
<h3 id="如何设计一个秒杀系统"><a href="#如何设计一个秒杀系统" class="headerlink" title="如何设计一个秒杀系统"></a>如何设计一个秒杀系统</h3><p>今天这篇文章咱们就开始从后端的角度来谈谈：“如何设计秒杀系统？”。</p>
<p>在你看这篇文章之前，我想说的是系统设计没有一个标准答案，你需要结合自己的过往经验来回答，我这篇文章也是简单说说自己的看法。</p>
<p><strong>下面是正文！</strong></p>
<p>设计秒杀系统之前，我们首先需要对秒杀系统有一个清晰的认识。</p>
<p>秒杀系统主要为商品（往往是爆款商品）秒杀活动提供支持，这个秒杀活动会限制商品的个数以及秒杀持续时间。</p>
<p><img src="/images/share/new-interview/b6868b10-8e2f-4b4c-899a-ae93248a2640.png" alt="img"></p>
<p><strong>为什么秒杀系统的设计是一个难点呢？</strong> 是因为它的业务复杂么？ 当然不是！</p>
<p>秒杀系统的业务逻辑非常简单，一般就是下订单减库存，难点在于我们如何保障秒杀能够顺利进行。</p>
<p><img src="/images/share/new-interview/233dc15c-ea84-4a23-b679-ebaa1763b70b.png" alt="img"></p>
<ul>
<li>秒杀开始的时候，会有大量用户同时参与进来，因此秒杀系统一定要满足 高并发 和 高性能 。</li>
<li>为了保证秒杀整个流程的顺利进行，整个秒杀系统必须要满足 高可用 。</li>
<li>除此之外，由于商品的库存有限，在面对大量订单的情况下，一定不能超卖，我们还需要保证 一致性 。</li>
</ul>
<blockquote>
<p>很多小伙伴可能不太了解当代三高互联网架构：高并发、高性能、高可用。</p>
<p>我这里简单解释一下：高并发简单来说就是能够同时处理很多用户请求。高性能简单来说就是处理用户的请求速度要快。高可用简单来说就是我们的系统要在趋近 100% 的时间内都能正确提供服务。</p>
</blockquote>
<p>知道了秒杀系统的特点之后，我们站在技术层面来思考一下：“设计秒杀系统的过程中需要重点关注哪些问题”。</p>
<ol>
<li>参与秒杀的商品属于热点数据，我们该如何处理热点数据？</li>
<li>商品的库存有限，在面对大量订单的情况下，如何解决超卖的问题？</li>
<li>如果系统用了消息队列，如何保证消息队列不丢失消息？</li>
<li>如何保证秒杀系统的高可用？</li>
<li>如何对项目进行压测？有哪些工具？</li>
<li>……</li>
</ol>
<p>好的，废话不多说！正式开始！</p>
<h4 id="高并发-高性能"><a href="#高并发-高性能" class="headerlink" title="高并发&amp;高性能"></a>高并发&amp;高性能</h4><h5 id="热点数据处理"><a href="#热点数据处理" class="headerlink" title="热点数据处理"></a>热点数据处理</h5><p><strong>何为热点数据？</strong> 热点数据指的就是某一时间段内被大量访问的数据，比如爆款商品的数据、新闻热点。</p>
<p><strong>为什么要关注热点数据？</strong> 热点数据可能仅仅占据系统所有数据的 0.1% ，但是其访问量可能是比其他所有数据之和还要多。不重点处理热点数据，势必会给系统资源消耗带来严峻的挑战。</p>
<p><strong>热点数据的分类？</strong> 根据热点数据的特点，我们通常将其分为两类：</p>
<ul>
<li><p>静态热点数据 ：可以提前预测到的热点数据比如要秒杀的商品。</p>
</li>
<li><p>动态热点数据 ： 不能够提前预测到的热点数据，需要通过一些手段动态检测系统运行情况产生。</p>
</li>
</ul>
<p>另外，处理热点数据的问题的关键就在于 <strong>我们如何找到这些热点数据（或者说热 key），然后将它们存在 jvm 内存里</strong>。 对于并发量非常一般的系统直接将热点数据存放进缓存比如 Redis 中就可以了，不过像淘宝、京东这种级别的并发量，如果把某些热点数据放在 Redis 中，直接可能就将整个 Redis 集群给干掉了。</p>
<p><strong>如何检测热点数据？</strong></p>
<p>我了解到的是市面上也有一些类似的中间件，比如京东零售的 <a target="_blank" rel="noopener" href="https://gitee.com/jd-platform-opensource/hotkey">hotkey</a> 就是一款专门用于检测热点数据的中间件，它可以毫秒级探测热点数据，毫秒级推送至服务器集群内存。相关阅读：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/xOzEj5HtCeh_ezHDPHw6Jw">京东毫秒级热 key 探测框架设计与实践，已完美支撑 618 大促</a> 。</p>
<p>另外，我们平时使用 Redis 做缓存比较多，关于如何快速定位 Redis 热点数据，可以看下<a target="_blank" rel="noopener" href="https://www.infoq.cn/article/3l3zaq4h8xpnom2glsyi">如何快速定位 Redis 热 key</a>这篇文章。</p>
<p><img src="/images/share/new-interview/20210625085635200.png" alt="img"></p>
<p><strong>如何处理热点数据？</strong> 热点数据一定要放在缓存中，并且最好可以写入到 jvm 内存一份（多级缓存），并设置个过期时间。需要注意写入到 jvm 的热点数据不宜过多，避免内存占用过大，一定要设置到淘汰策略。</p>
<p><strong>为什么还要放在 jvm 内存一份？</strong> 因为放在 jvm 内存中的数据访问速度是最快的，不存在什么网络开销。</p>
<h5 id="流量削峰"><a href="#流量削峰" class="headerlink" title="流量削峰"></a>流量削峰</h5><p><strong>消息队列</strong></p>
<p>秒杀开始之后的流量不是很大，我处理不了嘛！那我就先把这些请求放到消息队列中去。然后，咱后端服务再慢慢根据自己的能力去消费这些消息，这样就避免直接把后端服务打垮掉。</p>
<p><img src="/images/share/new-interview/image-20221014203252561.png" alt="img"></p>
<p>消息队列是一种非常实用的流量削峰手段。只要是涉及到流量削峰，那必然不可缺少消息队列。</p>
<p><strong>回答问题&#x2F;验证码</strong></p>
<p>我们可以在用户发起秒杀请求之前让其进行答题或者输入验证码。</p>
<p>这种方式一方面可以避免用户请求过于集中，另一方面可以有效解决用户使用脚本作弊。</p>
<p>回答问题&#x2F;验证码这一步建议除了对答案的正确性做校验，还需要对用户的提交时间做校验，比如提交时间过短（&lt;1s）的话，大概就是使用脚本来处理的。</p>
<h4 id="高可用"><a href="#高可用" class="headerlink" title="高可用"></a>高可用</h4><h5 id="集群化"><a href="#集群化" class="headerlink" title="集群化"></a>集群化</h5><p>如果我们想要保证系统中某一个组件的高可用，往往需要搭建集群来避免单点风险，比如说 Nginx 集群、Kafka 集群、Redis 集群。</p>
<p>我们拿 Redis 来举例说明。<strong>如果我们需要保证 Redis 高可用的话，该怎么做呢？</strong></p>
<p>你直接通过 Redis replication（异步复制） 搞个一主(master)多从(slave)来提高可用性和读吞吐量，slave 的多少取决于你的读吞吐量。</p>
<p><img src="/images/share/new-interview/20210510110935773.png" alt="img"></p>
<p>这样的方式有一个问题：一旦 master 宕机，slave 晋升成 master，同时需要修改应用方的主节点地址，还需要命令所有从节点去复制新的主节点，整个过程需要人工干预。</p>
<p>不过，这个问题我们可以通过 Sentinel（哨兵） 来解决。Redis Sentinel 是 Redis 官方推荐的高可用性(HA)解决方案。</p>
<p>Sentinel 是 Redis 的一种运行模式 ，它主要的作用就是对 Redis 运行节点进行监控。当 master 节点出现故障的时候， Sentinel 会帮助我们实现故障转移，确保整个 Redis 系统的可用性。整个过程完全自动，不需要人工介入!</p>
<p><img src="/images/share/new-interview/2021051011143961.png" alt="img"></p>
<p>Sentinel 也是一个 Redis 进程，只是不对外提供读写服务，通常哨兵要配置成单数。</p>
<h5 id="限流"><a href="#限流" class="headerlink" title="限流"></a>限流</h5><p>限流是从用户访问压力的角度来考虑如何应对系统故障。限流为了对服务端的接口接受请求的频率进行限制，防止服务挂掉。</p>
<p>🌰 举个例子：我们的秒杀接口一秒只能处理 10w 个请求，结果秒杀活动刚开始一下子来了 15w 个请求。这肯定不行啊！我们只能通过限流把 5w 个请求给拦截住，不然系统直接就给整挂掉了！</p>
<p>限流的话可以直接用 Redis 来做（建议基于 Lua 脚本），也可以使用现成的流量控制组件比如 Sentinel 、Hystrix 、Resilience4J 。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Netflix/Hystrix">Hystrix</a> 是 Netflix 开源的熔断降级组件。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/alibaba/Sentinel">Sentinel</a> 是阿里巴巴体提供的面向分布式服务架构的流量控制组件，经历了淘宝近10年双11（11.11）购物节的所有核心场景（比如秒杀活动）的考验。</p>
<p>Sentinel 主要以流量为切入点，提供 <strong>流量控制、熔断降级、系统自适应保护</strong>等功能来保护系统的稳定性和可用性。</p>
<p>个人比较建议使用 Sentinel ，更新维护频率更高，功能更强大，并且生态也更丰富（Sentinel 提供与 Spring Cloud、Dubbo 和 gRPC 等常用框架和库的开箱即用集成， Sentinel 未来还会对更多常用框架进行适配，并且会为 Service Mesh 提供集群流量防护的能力）。</p>
<p><img src="/images/share/new-interview/20210625091858288.png" alt="img"></p>
<h5 id="排队"><a href="#排队" class="headerlink" title="排队"></a>排队</h5><p>你可以把排队看作是限流的一个变种。限流是直接拒绝了用户的请求，而排队则是让用户等待一定的时间（类比现实世界的排队）。</p>
<p>排队虽然没有直接拒绝用户，但用户等了很长时间后进入系统，体验并不一定比限流好。</p>
<p>🌰 举个例子：当请求量达到一个阈值的时候，我们就通知用户让它们排队。等到系统可以继续处理请求之后，再慢慢来处理。</p>
<h5 id="降级"><a href="#降级" class="headerlink" title="降级"></a>降级</h5><p>降级是从系统功能优先级的角度考虑如何应对系统故障。</p>
<p>服务降级指的是当服务器压力剧增的情况下，根据当前业务情况及流量对一些服务和页面有策略的降级，以此释放服务器资源以保证核心任务的正常运行。降级的核心思想就是丢车保帅，优先保证核心业务。例</p>
<p>🌰 举个例子：当请求量达到一个阈值的时候，我们对系统中一些非核心的功能直接关闭或者让它们功能降低。这样的话，系统就有更多的资源留给秒杀功能了！</p>
<h5 id="熔断"><a href="#熔断" class="headerlink" title="熔断"></a>熔断</h5><p>熔断和降级是两个比较容易混淆的概念，两者的含义并不相同。降级的目的在于应对系统自身的故障，而熔断的目的在于应对当前系统依赖的外部系统或者第三方系统的故障。</p>
<p>熔断可以防止因为秒杀交易影响到其他正常服务的提供</p>
<p>🌰 举个例子： 秒杀功能位于服务 A 上，服务 A 上同时还有其他的一些功能比如商品管理。如果服务 A 上的商品管理接口响应非常慢的话，其他服务直接不再请求服务 A 上的商品管理这个接口，从而有效避免其他服务被拖慢甚至拖死。</p>
<h4 id="一致性"><a href="#一致性" class="headerlink" title="一致性"></a>一致性</h4><h5 id="减库存方案"><a href="#减库存方案" class="headerlink" title="减库存方案"></a>减库存方案</h5><p>常见的减库存方案有：</p>
<ul>
<li><p>下单即减库存 ：只要用户下单了，即使不付款，我们就扣库存。</p>
</li>
<li><p>付款再减库存 ：当用户付款了之后，我们在减库存。不过， 这种情况可能会造成用户下订单成功，但是付款失败。</p>
</li>
</ul>
<p>一般情况下都是 <strong>下单减扣库存</strong> ，像现在的购物网站比如京东都是这样来做的。</p>
<p>不过，我们还会对业务逻辑做进一步优化，比如说对超过一定时间不付款的订单特殊处理，释放库存。</p>
<p>对应到代码层面，我们应该如何保证不会超卖呢？</p>
<p>我们上面也说，我们一般会提前将秒杀商品的信息放到缓存中去。我们可以通过 Redis 对库存进行原子操作。伪代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一步：先检查 库存是否充足</span></span><br><span class="line"><span class="type">Integer</span> <span class="variable">stockNum</span> <span class="operator">=</span> (Integer)redisTemplate.get(key);</span><br><span class="line"><span class="keyword">if</span>(stockNum&lt;<span class="number">1</span>)&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 第二步：如果库存充足，减少库存（假设只能购买一件）</span></span><br><span class="line"><span class="type">Long</span> <span class="variable">count</span> <span class="operator">=</span> redisTemplate.increment(key,-<span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span>(count&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>你也可以通过 Lua 脚本来减少多个命令的网络开销并保证多个命令整体的原子性。伪代码如下：</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 第一步：先检查 库存是否充足，库存不足，返回0</span></span><br><span class="line"><span class="keyword">local</span> stockNum=<span class="built_in">tonumber</span>(redis.call(<span class="string">&quot;get&quot;</span>,key));</span><br><span class="line"><span class="keyword">if</span> stockNum&lt;<span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="comment">-- 第二部：如果库存充足，减少库存（假设只能购买一件），返回1</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    redis.call(<span class="string">&#x27;DECRBY&#x27;</span>,key,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h5 id="接口幂等"><a href="#接口幂等" class="headerlink" title="接口幂等"></a>接口幂等</h5><p><strong>什么是幂等呢?</strong> 在分布式系统中，幂等(idempotency)是对请求操作结果的一个描述，这个描述就是不论执行多少次相同的请求，产生的效果和返回的结果都和发出单个请求是一样的。</p>
<p>🌰 举个例子：假如咱们的前后端没有保证接口幂等性，我作为用户在秒杀商品的时候，我同时点击了多次秒杀商品按钮，后端处理了多次相同的订单请求，结果导致一个人秒杀了多个商品。这个肯定是不能出现的，属于非常严重的 bug 了！</p>
<p>保证分布式接口的幂等性对于数据的一致性至关重要，特别是像支付这种涉及到钱的接口。保证幂等性<strong>这个操作并不是说前端做了就可以的，后端同样要做。</strong></p>
<p>前端保证幂等性的话比较简单，一般通过当用户提交请求后将按钮致灰来做到。后端保证幂等性就稍微麻烦一点，方法也是有很多种，比如：</p>
<ol>
<li><p>同步锁；</p>
</li>
<li><p>分布式锁；</p>
</li>
<li><p>业务字段的唯一索性约束，防止重复数据产生。</p>
</li>
<li><p>……</p>
</li>
</ol>
<p>拿分布式锁来说，我们通过加锁的方式限制用户在第一次请求未结束之前，无法进行第二次请求。</p>
<p>分布式锁一般基于 Redis 来做比较多一些，这也是我比较推荐的一种方式。另外，如果使用 Redis 来实现分布式锁的话，比较推荐基于 Redisson。相关阅读：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=Mzg2OTA0Njk0OA==&mid=2247505586&idx=2&sn=7e9c7739b1a2c56849d371144556ff80&chksm=cea19979f9d6106f9b5fdce34a285e31d61981bdd58fe6b3a2fc9da23f21a9b01123d715dd96&token=1297266129&lang=zh_CN#rd">分布式锁中的王者方案 - Redisson</a> 。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.设置分布式锁</span></span><br><span class="line"><span class="type">RLock</span> <span class="variable">lock</span> <span class="operator">=</span> redisson.getLock(<span class="string">&quot;lock&quot;</span>);</span><br><span class="line"><span class="comment">// 2.占用锁</span></span><br><span class="line">lock.lock();</span><br><span class="line"><span class="comment">// 3.执行业务</span></span><br><span class="line">...</span><br><span class="line"><span class="comment">// 4.释放锁</span></span><br><span class="line">lock.unlock();</span><br></pre></td></tr></table></figure>



<p>当然了，除了 Redis 之外，像 ZooKeeper 等中间也可以拿来做分布式锁。</p>
<h4 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h4><p>上线之前压力测试是必不可少的。推荐 4 个比较常用的性能测试工具：</p>
<ol>
<li>**Jmeter ：**Apache JMeter 是 JAVA 开发的性能测试工具。</li>
<li>**LoadRunner：**一款商业的性能测试工具。</li>
<li>**Galtling ：**一款基于 Scala 开发的高性能服务器性能测试工具。</li>
<li>**ab ：**全称为 Apache Bench 。Apache 旗下的一款测试工具，非常实用。</li>
</ol>
<p>没记错的话，除了 <strong>LoadRunner</strong> 其他几款性能测试工具都是开源免费的。</p>
<h4 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h4><p>我简单画了一张图来总结一下上面涉及到的一些技术。</p>
<p><img src="/images/share/new-interview/20210624203212318.png" alt="img"></p>
<p>另外，上面涉及到知识点还蛮多的，如果面试官单独挑出一个来深挖还是能够问出很多问题的。</p>
<p>比如面试官想在消息队里上进行深挖，可能会问：</p>
<ul>
<li>常见消息队列的对比</li>
<li>如何保证消息的消费顺序？</li>
<li>如何保证消息不丢失？</li>
<li>如何保证消息不重复消费？</li>
<li>如何设计一个消息队列？</li>
<li>……</li>
</ul>
<p>再比如面试官想在 Redis 上深挖的话，可能会问：</p>
<ul>
<li>Redis 常用的数据结构了解么？</li>
<li>Redis 如何保证数据不丢失？</li>
<li>Redis 内存占用过大导致响应速度变慢怎么解决？</li>
<li>缓存穿透、缓存雪崩了解么？怎么解决？</li>
<li>……</li>
</ul>
<p>因此，要想要真正搞懂秒杀系统的设计，你还需要将其涉及到的一些技术给研究透！</p>

    </div>

    
    
    
        <div class="reward-container">
  <div>如果觉得不错，请作者喝杯咖啡！</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.jpg" alt="程序员波特 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.jpg" alt="程序员波特 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>

        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/images/wechat_channel.jpg">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" rel="tag"># 面试题</a>
              <a href="/tags/Java/" rel="tag"># Java</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/01/02/share/new-interview/rpc/" rel="prev" title="如何设计一个排行榜？">
      <i class="fa fa-chevron-left"></i> 如何设计一个排行榜？
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/01/02/share/new-interview/notice/" rel="next" title="如何设计一个站内消息系统?">
      如何设计一个站内消息系统? <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E6%80%8E%E4%B9%88%E5%81%9A%EF%BC%9F"><span class="nav-number">1.</span> <span class="nav-text">系统设计怎么做？</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Step1-%E9%97%AE%E6%B8%85%E6%A5%9A%E7%B3%BB%E7%BB%9F%E5%85%B7%E4%BD%93%E8%A6%81%E6%B1%82"><span class="nav-number">1.1.</span> <span class="nav-text">Step1:问清楚系统具体要求</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Step2-%E5%AF%B9%E7%B3%BB%E7%BB%9F%E8%BF%9B%E8%A1%8C%E6%8A%BD%E8%B1%A1%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.2.</span> <span class="nav-text">Step2:对系统进行抽象设计</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Step3-%E8%80%83%E8%99%91%E7%B3%BB%E7%BB%9F%E7%9B%AE%E5%89%8D%E9%9C%80%E8%A6%81%E4%BC%98%E5%8C%96%E7%9A%84%E7%82%B9"><span class="nav-number">1.3.</span> <span class="nav-text">Step3:考虑系统目前需要优化的点</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Step4-%E4%BC%98%E5%8C%96%E4%BD%A0%E7%9A%84%E7%B3%BB%E7%BB%9F%E6%8A%BD%E8%B1%A1%E8%AE%BE%E8%AE%A1"><span class="nav-number">1.4.</span> <span class="nav-text">Step4:优化你的系统抽象设计</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E8%AF%A5%E5%A6%82%E4%BD%95%E5%87%86%E5%A4%87%EF%BC%9F"><span class="nav-number">2.</span> <span class="nav-text">系统设计该如何准备？</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%9F%A5%E8%AF%86%E5%82%A8%E5%A4%87"><span class="nav-number">2.1.</span> <span class="nav-text">知识储备</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E6%88%98"><span class="nav-number">2.2.</span> <span class="nav-text">实战</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BF%9D%E6%8C%81%E5%A5%BD%E5%A5%87%E5%BF%83"><span class="nav-number">2.3.</span> <span class="nav-text">保持好奇心</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B"><span class="nav-number">2.4.</span> <span class="nav-text">技术选型</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E9%9D%A2%E8%AF%95%E5%BF%85%E7%9F%A5"><span class="nav-number">3.</span> <span class="nav-text">系统设计面试必知</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E7%9B%B8%E5%85%B3%E7%9A%84%E6%8C%87%E6%A0%87"><span class="nav-number">3.1.</span> <span class="nav-text">性能相关的指标</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4"><span class="nav-number">3.1.1.</span> <span class="nav-text">响应时间</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%B9%B6%E5%8F%91%E6%95%B0"><span class="nav-number">3.1.2.</span> <span class="nav-text">并发数</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#QPS-%E5%92%8C-TPS"><span class="nav-number">3.1.3.</span> <span class="nav-text">QPS 和 TPS</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%90%9E%E5%90%90%E9%87%8F"><span class="nav-number">3.1.4.</span> <span class="nav-text">吞吐量</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E6%B4%BB%E8%B7%83%E5%BA%A6"><span class="nav-number">3.2.</span> <span class="nav-text">系统活跃度</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#PV-Page-View"><span class="nav-number">3.2.1.</span> <span class="nav-text">PV(Page View)</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#UV-Unique-Visitor"><span class="nav-number">3.2.2.</span> <span class="nav-text">UV(Unique Visitor)</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#DAU-Daily-Active-User"><span class="nav-number">3.2.3.</span> <span class="nav-text">DAU(Daily Active User)</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#MAU-monthly-active-users"><span class="nav-number">3.2.4.</span> <span class="nav-text">MAU(monthly active users)</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7"><span class="nav-number">3.3.</span> <span class="nav-text">常用性能测试工具</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%90%8E%E7%AB%AF%E5%B8%B8%E7%94%A8"><span class="nav-number">3.3.1.</span> <span class="nav-text">后端常用</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%89%8D%E7%AB%AF%E5%B8%B8%E7%94%A8"><span class="nav-number">3.3.2.</span> <span class="nav-text">前端常用</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E8%BD%AF%E4%BB%B6%E7%9A%84QPS"><span class="nav-number">3.4.</span> <span class="nav-text">常见软件的QPS</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99"><span class="nav-number">3.5.</span> <span class="nav-text">系统设计原则</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5"><span class="nav-number">3.6.</span> <span class="nav-text">常见的性能优化策略</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%BF%85%E7%9F%A5%E6%B3%95%E5%88%99"><span class="nav-number">3.7.</span> <span class="nav-text">性能优化必知法则</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E9%9D%A2%E8%AF%95%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-number">4.</span> <span class="nav-text">系统设计面试的注意事项</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%83%B3%E5%A5%BD%E5%86%8D%E8%AF%B4"><span class="nav-number">4.1.</span> <span class="nav-text">想好再说</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B2%A1%E6%9C%89%E7%BB%9D%E5%AF%B9%E7%9A%84%E7%AD%94%E6%A1%88"><span class="nav-number">4.2.</span> <span class="nav-text">没有绝对的答案</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8B%BF%E8%A6%81%E7%BB%9D%E5%AF%B9"><span class="nav-number">4.3.</span> <span class="nav-text">勿要绝对</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9D%83%E8%A1%A1%E5%88%A9%E5%BC%8A"><span class="nav-number">4.4.</span> <span class="nav-text">权衡利弊</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%85%A2%E6%85%A2%E4%BC%98%E5%8C%96"><span class="nav-number">4.5.</span> <span class="nav-text">慢慢优化</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%8D%E8%BF%BD%E6%96%B0%E6%8A%80%E6%9C%AF"><span class="nav-number">4.6.</span> <span class="nav-text">不追新技术</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%BD%E7%AE%80%E9%81%BF%E6%9D%82"><span class="nav-number">4.7.</span> <span class="nav-text">追简避杂</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">5.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F"><span class="nav-number"></span> <span class="nav-text">如何设计一个秒杀系统</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%AB%98%E5%B9%B6%E5%8F%91-%E9%AB%98%E6%80%A7%E8%83%BD"><span class="nav-number">1.</span> <span class="nav-text">高并发&amp;高性能</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%83%AD%E7%82%B9%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="nav-number">1.1.</span> <span class="nav-text">热点数据处理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B5%81%E9%87%8F%E5%89%8A%E5%B3%B0"><span class="nav-number">1.2.</span> <span class="nav-text">流量削峰</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%AB%98%E5%8F%AF%E7%94%A8"><span class="nav-number">2.</span> <span class="nav-text">高可用</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%9B%86%E7%BE%A4%E5%8C%96"><span class="nav-number">2.1.</span> <span class="nav-text">集群化</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%99%90%E6%B5%81"><span class="nav-number">2.2.</span> <span class="nav-text">限流</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8E%92%E9%98%9F"><span class="nav-number">2.3.</span> <span class="nav-text">排队</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%99%8D%E7%BA%A7"><span class="nav-number">2.4.</span> <span class="nav-text">降级</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%86%94%E6%96%AD"><span class="nav-number">2.5.</span> <span class="nav-text">熔断</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E8%87%B4%E6%80%A7"><span class="nav-number">3.</span> <span class="nav-text">一致性</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%87%8F%E5%BA%93%E5%AD%98%E6%96%B9%E6%A1%88"><span class="nav-number">3.1.</span> <span class="nav-text">减库存方案</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3%E5%B9%82%E7%AD%89"><span class="nav-number">3.2.</span> <span class="nav-text">接口幂等</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95"><span class="nav-number">4.</span> <span class="nav-text">性能测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-1"><span class="nav-number">5.</span> <span class="nav-text">总结</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="程序员波特"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">程序员波特</p>
  <div class="site-description" itemprop="description">程序员编程资料站</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">137</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">蜀ICP备2023040197号-1 </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">程序员波特</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
